<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><!--COMPANY_TITLE--></title>
  <!--HEAD-->
</head>
<body class="company-detail-page" data-company-slug="<!--COMPANY_SLUG-->">
  <!--HEADER-->
  <div class="page">
    <section class="company-detail">
      <!--COMPANY_HERO_SECTION-->
      <div class="company-detail-top">
        <div class="company-detail-title">
          <h1><!--COMPANY_NAME--></h1>
          <!--COMPANY_VALUE_LINE-->
          <!--COMPANY_VALUE_SUBLINE-->
          <!--COMPANY_SOURCE_LINE-->
          <div class="company-detail-meta">
            <span>行业：<!--COMPANY_INDUSTRY--></span>
            <span>城市：<!--COMPANY_CITY--></span>
          </div>
          <div class="company-detail-body company-detail-body--inline">
            <h2>简介</h2>
            <!--COMPANY_SUMMARY_LINES-->
          </div>
        </div>
        <!--COMPANY_ACTION_CARD-->
      </div>
      <!--COMPANY_MAP_SECTION-->
      <!--COMPANY_DETAIL_SECTION-->
      <!--COMPANY_ACTION_BAR-->
    </section>
  </div>
  <!--FOOTER-->
  <script>
    (() => {
    const mapToggles = document.querySelectorAll('[data-map-toggle]');
    const mapEmbed = document.querySelector('[data-map-embed]');
    const updateMapLabels = (open) => {
      mapToggles.forEach((button) => {
        const label = button.dataset.mapLabel || '展开地图';
        button.textContent = open ? '收起地图' : label;
      });
    };
    if (mapToggles.length && mapEmbed) {
      const initialOpen = mapEmbed.classList.contains('map-embed--open');
      updateMapLabels(initialOpen);
      mapToggles.forEach((button) => {
        button.addEventListener('click', () => {
          const open = mapEmbed.classList.toggle('map-embed--open');
          updateMapLabels(open);
          if (open) {
            mapEmbed.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
        });
      });
    }

      const shareBtn = document.querySelector('[data-share]');
      if (shareBtn) {
        shareBtn.addEventListener('click', async () => {
          const url = window.location.href;
          const title = document.querySelector('h1')?.textContent?.trim() || document.title;
          if (navigator.share) {
            try {
              await navigator.share({ title, url });
              return;
            } catch (err) {
              // Fall back to clipboard.
            }
          }
          if (navigator.clipboard?.writeText) {
            await navigator.clipboard.writeText(url);
            const original = shareBtn.textContent;
            shareBtn.textContent = '链接已复制';
            window.setTimeout(() => {
              shareBtn.textContent = original;
            }, 1800);
          }
        });
      }

      const copyButtons = document.querySelectorAll('[data-copy]');
      copyButtons.forEach((button) => {
        button.addEventListener('click', async () => {
          const encoded = button.dataset.copy || '';
          if (!encoded) return;
          const value = decodeURIComponent(encoded);
          if (navigator.clipboard?.writeText) {
            await navigator.clipboard.writeText(value);
            const original = button.textContent;
            button.textContent = '已复制';
            window.setTimeout(() => {
              button.textContent = original;
            }, 1800);
          }
        });
      });

      const favoriteBtn = document.querySelector('[data-favorite]');
      const slug = document.body.dataset.companySlug;
      if (favoriteBtn && slug) {
        const storageKey = 'mx_favorites';
        const loadFavorites = () => {
          try {
            const raw = window.localStorage.getItem(storageKey);
            return raw ? JSON.parse(raw) : [];
          } catch (err) {
            return [];
          }
        };
        const saveFavorites = (list) => {
          window.localStorage.setItem(storageKey, JSON.stringify(list));
        };
        const updateFavorite = (isFav) => {
          favoriteBtn.classList.toggle('is-active', isFav);
          favoriteBtn.textContent = isFav ? '已收藏' : '收藏';
        };
        const favorites = loadFavorites();
        updateFavorite(favorites.includes(slug));
        favoriteBtn.addEventListener('click', () => {
          const list = loadFavorites();
          const exists = list.includes(slug);
          const next = exists ? list.filter((item) => item !== slug) : [...list, slug];
          saveFavorites(next);
          updateFavorite(!exists);
        });
      }

      const galleryGrid = document.querySelector('.company-hero-grid[data-gallery]');
      const galleryOpen = document.querySelector('[data-gallery-open]');
      if (galleryGrid && galleryOpen) {
        const images = (galleryGrid.dataset.gallery || '').split('|').map((item) => item.trim()).filter(Boolean);
        if (images.length) {
          const buildModal = (startIndex = 0) => {
            let current = startIndex;
            const modal = document.createElement('div');
            modal.className = 'gallery-modal';
            modal.innerHTML = `
              <div class="gallery-modal__content">
                <button class="gallery-modal__close" type="button" data-gallery-close>关闭</button>
                <img class="gallery-modal__image" src="${images[current]}" alt="图集预览">
                <div class="gallery-modal__nav">
                  <button class="gallery-modal__btn" type="button" data-gallery-prev>上一张</button>
                  <span>${current + 1} / ${images.length}</span>
                  <button class="gallery-modal__btn" type="button" data-gallery-next>下一张</button>
                </div>
              </div>
            `;
            document.body.appendChild(modal);
            document.body.classList.add('gallery-open');

            const img = modal.querySelector('.gallery-modal__image');
            const counter = modal.querySelector('.gallery-modal__nav span');
            const update = () => {
              img.src = images[current];
              counter.textContent = `${current + 1} / ${images.length}`;
            };

            const close = () => {
              modal.remove();
              document.body.classList.remove('gallery-open');
              document.removeEventListener('keydown', onKeydown);
            };

            const prev = () => {
              current = (current - 1 + images.length) % images.length;
              update();
            };

            const next = () => {
              current = (current + 1) % images.length;
              update();
            };

            const onKeydown = (event) => {
              if (event.key === 'Escape') close();
              if (event.key === 'ArrowLeft') prev();
              if (event.key === 'ArrowRight') next();
            };

            modal.addEventListener('click', (event) => {
              if (event.target === modal) close();
            });
            modal.querySelector('[data-gallery-close]').addEventListener('click', close);
            modal.querySelector('[data-gallery-prev]').addEventListener('click', prev);
            modal.querySelector('[data-gallery-next]').addEventListener('click', next);
            document.addEventListener('keydown', onKeydown);
          };

          galleryOpen.addEventListener('click', () => buildModal(0));
        }
      }
    })();
  </script>
</body>
</html>
